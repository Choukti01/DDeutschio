<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>B2 - Deutschio</title>
  <link rel="stylesheet" href="stylesB2.css">
  <link rel="stylesheet" href="LawB2.css">

</head>
<body>
  <header class="hero-b2">
    <h1 class="main-title">Deutschio</h1>
    <p class="main-desc"> B2 ‚Üí Select a topic to start learning. </p>
  </header>

  <div class="section-menu">
    <button class="quiz-btn" onclick="location.href='lawB2.html'">Law</button>
    <br>
    <br>
    <button class="quiz-btn" onclick="location.href='economicsB2.html'">Economics</button>
    <br>
    <br>
    <button class="quiz-btn" onclick="location.href='scienceB2.html'">Science</button>
    <br>
    <br>
    <button class="quiz-btn" onclick="location.href='publicSpeakingB2.html'">Public Speaking</button>
  </div>




  
  <!-- // B2 quiz  -->
  <script>
  // quiz logic
  (function () {
    // Quiz data (front = German, back = English)
    const QUIZ_DATA = {
      law: [
        { front: "das Gesetz", back: "law" },
        { front: "die Verfassung", back: "constitution" },
        { front: "die Rechte", back: "rights" },
        { front: "die Pflichten", back: "duties" },
        { front: "der Richter", back: "judge" },
        { front: "der Anwalt", back: "lawyer" },
        { front: "das Gericht", back: "court" },
        { front: "das Urteil ", back: "verdict" },
        { front: "der Angeklagte", back: "defendant" },
        { front: "die Verteidigung", back: "defense" }
      ],
      economics: [
        { front: "die Wirtschaft", back: "economy" },
        { front: "das Angebot", back: "supply" },
        { front: "die Nachfrage", back: "demand" },
        { front: "das Wachstum", back: "growth" },
        { front: "die Inflation", back: "inflation" },
        { front: "die Rezession", back: "recession" },
        { front: "die Investition", back: "investment" },
        { front: "das Unternehmen", back: "company / enterprise" },
        { front: "der Markt", back: "market" },
        { front: "die Produktion", back: "production" }
      ],
      science: [
        { front: "die Wissenschaft", back: "science" },
        { front: "der Forscher", back: "researcher" },
        { front: "die Forschung", back: "research" },
        { front: "das Experiment ", back: "experiment" },
        { front: "die Theorie", back: "theory" },
        { front: "die Methode ", back: "method" },
        { front: "das Labor", back: "laboratory" },
        { front: "die Entdeckung", back: "discovery" },
        { front: "die Innovation", back: "innovation" },
        { front: "die Technologie", back: "technology" }
      ],
      publicSpeaking: [
        { front: "die Rede", back: "speech" },
        { front: "der Vortrag", back: "presentation" },
        { front: "das Publikum", back: "audience" },
        { front: "die K√∂rpersprache", back: "body language" },
        { front: "die Stimme", back: "voice" },
        { front: "die Betonung", back: "emphasis / stress" },
        { front: "das Lampenfieber", back: "stage fright" },
        { front: "die Rhetorik", back: "rhetoric" },
        { front: "die √úberzeugungskraft", back: "power of persuasion" },
        { front: "die Gestik", back: "gestures" }
      ]
    };

    const TOPICS = [
      { key: "law", title: "law" },
      { key: "economics", title: "economics" },
      { key: "science", title: "science" },
      { key: "publicSpeaking", title: "publicSpeaking" }
    ];

    const PASS_RATIO = 0.7; // 70% to pass each quiz

    //  quizzes container and inject 
    function buildQuizzes() {
      const container = document.createElement("section");
      container.id = "quizzes";
      container.className = "quizzes";

      TOPICS.forEach((topicObj, idx) => {
        const data = QUIZ_DATA[topicObj.key] || [];
        const quizDiv = document.createElement("div");
        quizDiv.className = "quiz";
        quizDiv.dataset.index = String(idx);
        quizDiv.dataset.topic = topicObj.key;

        // structure injected into DOM
        quizDiv.innerHTML = `
          <div class="quiz-header">
            <h2 class="quiz-title">Quiz ${idx + 1} ‚Äî ${topicObj.title}</h2>
            <div class="quiz-sub">Flashcard quiz ¬∑ Pass to unlock next</div>
          </div>

          <div class="card-container" aria-live="polite">
            <div class="card" tabindex="0">
              <div class="card-inner">
                <div class="face front"></div>
                <div class="face back"></div>
              </div>
            </div>
          </div>

          <div class="controls">
            <button class="flip-btn">Flip</button>
            <button class="knew-btn" disabled>I knew it</button>
            <button class="dont-btn" disabled>I didn't know</button>
          </div>

          <div class="meta">
            <div class="progress">0 / ${data.length}</div>
            <div class="result"></div>
          </div>

          <div class="lock-overlay">Locked ‚Äî pass previous quiz to unlock.</div>
        `;

        // initially lock every quiz except the first
        if (idx > 0) {
          quizDiv.classList.add("locked");
        } else {
          // show pass hint for first quiz
          quizDiv.classList.add("unlocked");
        }

        container.appendChild(quizDiv);
      });

      const menu = document.querySelector(".section-menu");
      if (menu && menu.parentNode) {
        menu.parentNode.insertBefore(container, menu.nextSibling);
      } else {
        document.body.appendChild(container);
      }
    }

    // Setup interactivity
    function initQuizzesBehavior() {
      const quizzes = document.querySelectorAll(".quiz");
      quizzes.forEach((quizEl) => {
        const idx = Number(quizEl.dataset.index);
        const topic = quizEl.dataset.topic;
        const items = QUIZ_DATA[topic] || [];
        const total = items.length;

        let state = {
          current: 0,
          score: 0,
          finished: false
        };

        const card = quizEl.querySelector(".card");
        const cardInner = quizEl.querySelector(".card-inner");
        const frontFace = quizEl.querySelector(".face.front");
        const backFace = quizEl.querySelector(".face.back");

        const flipBtn = quizEl.querySelector(".flip-btn");
        const knewBtn = quizEl.querySelector(".knew-btn");
        const dontBtn = quizEl.querySelector(".dont-btn");
        const progressEl = quizEl.querySelector(".progress");
        const resultEl = quizEl.querySelector(".result");
        const lockOverlay = quizEl.querySelector(".lock-overlay");

        const passCount = Math.ceil(total * PASS_RATIO);

        function renderCard() {
          const item = items[state.current];
          frontFace.textContent = item ? item.front : "";
          backFace.textContent = item ? item.back : "";
          progressEl.textContent = `${Math.min(state.current + 1, total)} / ${total}`;
          // ensure card shows front
          cardInner.classList.remove("flipped");
          // disable knew/don't until user flips
          knewBtn.disabled = true;
          dontBtn.disabled = true;
          flipBtn.disabled = quizEl.classList.contains("locked") || state.finished;
        }

        function showResult() {
          resultEl.innerHTML = `
            <div class="score">You scored ${state.score} / ${total} (${Math.round((state.score/total)*100)}%)</div>
          `;
          if (state.score >= passCount) {
            resultEl.innerHTML += `<div class="pass">üéâ Passed! ${state.score} of ${total}. Next quiz unlocked.</div>`;
            quizEl.classList.add("passed");
            unlockNextQuiz(idx);
          } else {
            resultEl.innerHTML += `<div class="fail">‚ùå Not passed. Need at least ${passCount}/${total}. Try again.</div>
            <button class="retry-btn">Retry</button>`;
            const retryBtn = resultEl.querySelector(".retry-btn");
            retryBtn.addEventListener("click", () => {
              state.current = 0;
              state.score = 0;
              state.finished = false;
              resultEl.innerHTML = "";
              renderCard();
              flipBtn.disabled = quizEl.classList.contains("locked");
            });
          }

          // disable interaction after finishing
          state.finished = true;
          flipBtn.disabled = true;
          knewBtn.disabled = true;
          dontBtn.disabled = true;
        }

        function nextCard(known) {
          if (known) state.score++;
          state.current++;
          if (state.current >= total) {
            showResult();
          } else {
            renderCard();
          }
        }

        // unlock next quiz in order
        function unlockNextQuiz(currentIndex) {
          const nextIndex = currentIndex + 1;
          const nextQuiz = document.querySelector(`.quiz[data-index="${nextIndex}"]`);
          if (nextQuiz) {
            nextQuiz.classList.remove("locked");
            nextQuiz.classList.add("unlocked");
            const overlay = nextQuiz.querySelector(".lock-overlay");
            if (overlay) overlay.style.display = "none";
            // enable flip button of next quiz (others will be enabled when interacting)
            const nextFlip = nextQuiz.querySelector(".flip-btn");
            if (nextFlip) nextFlip.disabled = false;
            // visual pulse
            nextQuiz.classList.add("just-unlocked");
            setTimeout(() => nextQuiz.classList.remove("just-unlocked"), 2000);
          }
        }

        // event handlers
        // card click / keyboard flips
        function toggleFlip() {
          if (quizEl.classList.contains("locked") || state.finished) return;
          cardInner.classList.toggle("flipped");
          const isBack = cardInner.classList.contains("flipped");
          // enable answer buttons only when back is visible
          knewBtn.disabled = !isBack;
          dontBtn.disabled = !isBack;
        }

        card.addEventListener("click", toggleFlip);
        card.addEventListener("keydown", (ev) => {
          if (ev.key === "Enter" || ev.key === " ") {
            ev.preventDefault();
            toggleFlip();
          }
        });

        flipBtn.addEventListener("click", (ev) => {
          ev.preventDefault();
          toggleFlip();
        });

        knewBtn.addEventListener("click", (ev) => {
          ev.preventDefault();
          if (quizEl.classList.contains("locked") || state.finished) return;
          // ensure back currently visible
          if (!cardInner.classList.contains("flipped")) {
            // force flip then wait briefly
            cardInner.classList.add("flipped");
            setTimeout(() => {
              nextCard(true);
            }, 350);
            return;
          }
          nextCard(true);
        });

        dontBtn.addEventListener("click", (ev) => {
          ev.preventDefault();
          if (quizEl.classList.contains("locked") || state.finished) return;
          if (!cardInner.classList.contains("flipped")) {
            cardInner.classList.add("flipped");
            setTimeout(() => {
              nextCard(false);
            }, 350);
            return;
          }
          nextCard(false);
        });

        // initialize state for this quiz
        if (quizEl.classList.contains("locked")) {
          // visually show overlay
          if (lockOverlay) lockOverlay.style.display = "flex";
          flipBtn.disabled = true;
          knewBtn.disabled = true;
          dontBtn.disabled = true;
        } else {
          if (lockOverlay) lockOverlay.style.display = "none";
          flipBtn.disabled = false;
        }

        renderCard();
      });
    }

    // build & init
    document.addEventListener("DOMContentLoaded", () => {
      buildQuizzes();
      initQuizzesBehavior();
    });

    // in case DOMContentLoaded already fired
    if (document.readyState === "interactive" || document.readyState === "complete") {
      if (!document.querySelector("#quizzes")) {
        buildQuizzes();
        initQuizzesBehavior();
      }
    }
  })();
  </script>



</body>
</html>
